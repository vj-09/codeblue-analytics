[
  {
    "question_id": "bank_hard_001",
    "question": "Divide customers into 4 day quartiles. What is the subscription percentage (0-100) in the lower-middle (25-50%) (Q2) quartile?",
    "exec_success": true,
    "correct": false,
    "generated_code": "q2_days = df['day'].quantile([0.25, 0.5])\nresult = (df[(df['day'] >= q2_days.iloc[0]) & (df['day'] <= q2_days.iloc[1])]['y'].mean() * 100).round(2)",
    "result": 13.63,
    "expected": 14.04,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:34.800492",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.5031418800354004
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 day quartiles. What is the subscription percentage (0-100) in the lower-middle (25-50%) (Q2) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_002",
    "question": "Show the subscription percentage breakdown by job. Return a DataFrame with columns [job, count, rate] where rate is percentage (0-100), sorted by rate descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = (df.groupby('job')['y'].mean() * 100).reset_index().rename(columns={'y': 'rate'})\nresult['count'] = df['job'].value_counts().sort_index().values\nresult = result[['job', 'count', 'rate']].sort_values('rate', ascending=False)",
    "result": [
      {
        "job": "student",
        "count": 11767,
        "rate": 34.07835472082944
      },
      {
        "job": "retired",
        "count": 35185,
        "rate": 24.62412960068211
      },
      {
        "job": "unemployed",
        "count": 17634,
        "rate": 17.982306907111262
      },
      {
        "job": "management",
        "count": 175541,
        "rate": 15.039221606348374
      },
      {
        "job": "self-employed",
        "count": 19020,
        "rate": 12.944269190325972
      },
      {
        "job": "unknown",
        "count": 2917,
        "rate": 12.067192320877613
      },
      {
        "job": "technician",
        "count": 138107,
        "rate": 11.832130159948445
      },
      {
        "job": "admin.",
        "count": 81492,
        "rate": 11.645314877533991
      },
      {
        "job": "housemaid",
        "count": 15912,
        "rate": 8.465309200603318
      },
      {
        "job": "services",
        "count": 64209,
        "rate": 8.271426124063606
      },
      {
        "job": "entrepreneur",
        "count": 17718,
        "rate": 8.1386160966249
      },
      {
        "job": "blue-collar",
        "count": 170498,
        "rate": 6.743774120517543
      }
    ],
    "expected": [
      {
        "job": "student",
        "count": 11767,
        "rate": 34.08
      },
      {
        "job": "retired",
        "count": 35185,
        "rate": 24.62
      },
      {
        "job": "unemployed",
        "count": 17634,
        "rate": 17.98
      },
      {
        "job": "management",
        "count": 175541,
        "rate": 15.04
      },
      {
        "job": "self-employed",
        "count": 19020,
        "rate": 12.94
      },
      {
        "job": "unknown",
        "count": 2917,
        "rate": 12.07
      },
      {
        "job": "technician",
        "count": 138107,
        "rate": 11.83
      },
      {
        "job": "admin.",
        "count": 81492,
        "rate": 11.65
      },
      {
        "job": "housemaid",
        "count": 15912,
        "rate": 8.47
      },
      {
        "job": "services",
        "count": 64209,
        "rate": 8.27
      },
      {
        "job": "entrepreneur",
        "count": 17718,
        "rate": 8.14
      },
      {
        "job": "blue-collar",
        "count": 170498,
        "rate": 6.74
      }
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:37.322466",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.218532085418701
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the subscription percentage breakdown by job. Return a DataFrame with columns [job, count, rate] where rate is percentage (0-100), sorted by rate descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_003",
    "question": "Rank job categories by customer count. Return the top 3 as a list from highest to lowest count.",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = df['job'].value_counts().nlargest(3).index.tolist()",
    "result": [
      "management",
      "blue-collar",
      "technician"
    ],
    "expected": [
      "management",
      "blue-collar",
      "technician"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:39.559983",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.6241631507873535
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Rank job categories by customer count. Return the top 3 as a list from highest to lowest count.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_004",
    "question": "Which month categories are anomalies - having above-median balance but below-median subscription rate? Return sorted list.",
    "exec_success": true,
    "correct": false,
    "generated_code": "balance_median = df['balance'].median()\ny_median = df['y'].median()\n\nanomalies = df[(df['balance'] > balance_median) & (df['y'] < y_median)]['month'].unique()\nresult = sorted(anomalies)",
    "result": [],
    "expected": [
      "nov"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:42.203251",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.3631529808044434
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories are anomalies - having above-median balance but below-median subscription rate? Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_005",
    "question": "Find the job with the lowest subscription rate. Within that group, what is the lowest average age?",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df.groupby('job')['y'].mean().idxmin()\nresult_avg_age = df.loc[df['job'] == result, 'age'].min()",
    "result": "blue-collar",
    "expected": 40.45,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:43.585366",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.8318488597869873
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the lowest subscription rate. Within that group, what is the lowest average age?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_006",
    "question": "Which month category has the highest subscription rate? If tied, return alphabetically first.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df[df['y'] == 1]['month'].value_counts().index[0]",
    "result": "may",
    "expected": "mar",
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:45.436099",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.082275152206421
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month category has the highest subscription rate? If tied, return alphabetically first.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_007",
    "question": "How much higher is the subscription rate for month='may' compared to month='aug'? Return percentage points difference.",
    "exec_success": true,
    "correct": true,
    "generated_code": "may_subscription_rate = (df[df['month'] == 'may']['y'] == 1).mean()\naug_subscription_rate = (df[df['month'] == 'aug']['y'] == 1).mean()\nresult = (may_subscription_rate - aug_subscription_rate) * 100",
    "result": -4.0807523188505,
    "expected": -4.08,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:46.537331",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.172616958618164
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate for month='may' compared to month='aug'? Return percentage points difference.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_008",
    "question": "Which job categories have more than 50000 customers? Return as a sorted list.",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = df['job'].value_counts()[lambda x: x > 50000].index.tolist()\nresult.sort()",
    "result": [
      "admin.",
      "blue-collar",
      "management",
      "services",
      "technician"
    ],
    "expected": [
      "admin.",
      "blue-collar",
      "management",
      "services",
      "technician"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:48.728860",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.3936679363250732
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which job categories have more than 50000 customers? Return as a sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_009",
    "question": "Which month category has the lowest average balance? If tied, return alphabetically first.",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = df.groupby('month')['balance'].mean().idxmin()",
    "result": "jul",
    "expected": "jul",
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:50.141415",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.6367628574371338
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month category has the lowest average balance? If tied, return alphabetically first.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_010",
    "question": "How much higher is the subscription rate for job='management' compared to job='services'? Return percentage points difference.",
    "exec_success": true,
    "correct": true,
    "generated_code": "subscription_rate_management = (df[df['job'] == 'management']['y'].mean()) * 100\nsubscription_rate_services = (df[df['job'] == 'services']['y'].mean()) * 100\nresult = subscription_rate_management - subscription_rate_services",
    "result": 6.767795482284768,
    "expected": 6.77,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:51.797022",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.107012987136841
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate for job='management' compared to job='services'? Return percentage points difference.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_011",
    "question": "Which job categories are anomalies - having above-median age but below-median subscription rate? Return sorted list.",
    "exec_success": true,
    "correct": false,
    "generated_code": "median_age = df['age'].median()\nmedian_subscription = df['y'].median()\nanomalies = df[(df['age'] > median_age) & (df['y'] < median_subscription)]['job'].unique()\nresult = sorted(anomalies)",
    "result": [],
    "expected": [
      "blue-collar",
      "entrepreneur",
      "housemaid"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:53.922894",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.822700023651123
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which job categories are anomalies - having above-median age but below-median subscription rate? Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_012",
    "question": "How much higher is the average age for month='may' compared to month='nov'?",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = df.loc[df['month'] == 'may', 'age'].mean() - df.loc[df['month'] == 'nov', 'age'].mean()",
    "result": -2.8126264550680276,
    "expected": -2.81,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:55.764512",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.7381720542907715
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the average age for month='may' compared to month='nov'?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_013",
    "question": "Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the lower-middle (25-50%) (Q2) quartile?",
    "exec_success": true,
    "correct": false,
    "generated_code": "q2_balance = df['balance'].quantile(0.5)\nq1_balance = df['balance'].quantile(0.25)\nq2_customers = df[(df['balance'] >= q1_balance) & (df['balance'] <= q2_balance)]\nresult = (q2_customers['y'].sum() / len(q2_customers)) * 100",
    "result": 8.815985926944284,
    "expected": 10.96,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:57.521666",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.8263092041015625
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the lower-middle (25-50%) (Q2) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_014",
    "question": "How much higher is the subscription rate in the Q4 balance quartile compared to Q1? Return percentage points.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = (df['balance'].quantile(0.75).mean() - df['balance'].quantile(0.25).mean()) * 100",
    "result": 139000.0,
    "expected": 16.95,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:49:59.373655",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.1950178146362305
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate in the Q4 balance quartile compared to Q1? Return percentage points.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_015",
    "question": "Score each job by opportunity: (count * (1 - subscription_rate) * avg_day). Return a DataFrame with top 5 segments showing [count, rate (percentage 0-100), avg_metric, opportunity_score], sorted by score descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "job_metrics = df.groupby('job')['y'].agg(count='count', rate=lambda x: 100 * x.mean())\njob_metrics['avg_day'] = df.groupby('job')['day'].mean()\njob_metrics['opportunity_score'] = job_metrics['count'] * (100 - job_metrics['rate']) * job_metrics['avg_day']\nresult = job_metrics[['count', 'rate', 'avg_day', 'opportunity_score']].sort_values('opportunity_score', ascending=False).head(5)",
    "result": [
      {
        "count": 170498,
        "rate": 6.743774120517543,
        "avg_day": 15.703973067132752,
        "opportunity_score": 249693171.76741076
      },
      {
        "count": 175541,
        "rate": 15.039221606348374,
        "avg_day": 16.36592021237204,
        "opportunity_score": 244082970.63933784
      },
      {
        "count": 138107,
        "rate": 11.832130159948445,
        "avg_day": 16.829110761945447,
        "opportunity_score": 204921350.10390493
      },
      {
        "count": 81492,
        "rate": 11.645314877533991,
        "avg_day": 15.911390075099396,
        "opportunity_score": 114565190.81873067
      },
      {
        "count": 64209,
        "rate": 8.271426124063606,
        "avg_day": 15.973648553941036,
        "opportunity_score": 94081595.25300191
      }
    ],
    "expected": [
      {
        "job": "blue-collar",
        "count": 170498,
        "rate": 6.74,
        "avg_metric": 15.7,
        "opportunity_score": 2496931.72
      },
      {
        "job": "management",
        "count": 175541,
        "rate": 15.04,
        "avg_metric": 16.37,
        "opportunity_score": 2440829.71
      },
      {
        "job": "technician",
        "count": 138107,
        "rate": 11.83,
        "avg_metric": 16.83,
        "opportunity_score": 2049213.5
      },
      {
        "job": "admin.",
        "count": 81492,
        "rate": 11.65,
        "avg_metric": 15.91,
        "opportunity_score": 1145651.91
      },
      {
        "job": "services",
        "count": 64209,
        "rate": 8.27,
        "avg_metric": 15.97,
        "opportunity_score": 940815.95
      }
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:01.587543",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.4414420127868652
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Score each job by opportunity: (count * (1 - subscription_rate) * avg_day). Return a DataFrame with top 5 segments showing [count, rate (percentage 0-100), avg_metric, opportunity_score], sorted by score descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_016",
    "question": "Find the job with the highest subscription rate. Within that group, what is the lowest average age?",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df.assign(subscribed=df['y']).groupby('job')['subscribed'].mean().idxmin()\naverage_age = df[df['job'] == result]['age'].mean()\nresult = (result, average_age)",
    "result": [
      "blue-collar",
      40.450063930368685
    ],
    "expected": 26.69,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:04.047861",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.1265788078308105
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the highest subscription rate. Within that group, what is the lowest average age?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_017",
    "question": "Score each job by opportunity: (count * (1 - subscription_rate) * avg_balance). Return a DataFrame with top 5 segments showing [count, rate (percentage 0-100), avg_metric, opportunity_score], sorted by score descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "subscription_rate = df.groupby('job')['y'].mean()\ndf_job = df.groupby('job').agg(count=('id', 'count'), avg_metric=('balance', 'mean'))\ndf_job['rate'] = subscription_rate.values * 100\ndf_job['opportunity_score'] = df_job['count'] * (1 - df_job['rate'] / 100) * df_job['avg_metric']\nresult = df_job.sort_values('opportunity_score', ascending=False)[['count', 'rate', 'avg_metric', 'opportunity_score']].head(5)",
    "result": [
      {
        "count": 175541,
        "rate": 15.039221606348374,
        "avg_metric": 1510.3852832101902,
        "opportunity_score": 225260371.52325097
      },
      {
        "count": 170498,
        "rate": 6.743774120517543,
        "avg_metric": 977.4941817499325,
        "opportunity_score": 155421574.89823928
      },
      {
        "count": 138107,
        "rate": 11.832130159948445,
        "avg_metric": 1071.5715351140782,
        "opportunity_score": 130480979.54470086
      },
      {
        "count": 81492,
        "rate": 11.645314877533991,
        "avg_metric": 1019.9245815540175,
        "opportunity_score": 73436609.72105238
      },
      {
        "count": 64209,
        "rate": 8.271426124063606,
        "avg_metric": 834.6257066766341,
        "opportunity_score": 49157784.871840395
      }
    ],
    "expected": [
      {
        "job": "management",
        "count": 175541,
        "rate": 15.04,
        "avg_metric": 1510.39,
        "opportunity_score": 225260371.52
      },
      {
        "job": "blue-collar",
        "count": 170498,
        "rate": 6.74,
        "avg_metric": 977.49,
        "opportunity_score": 155421574.9
      },
      {
        "job": "technician",
        "count": 138107,
        "rate": 11.83,
        "avg_metric": 1071.57,
        "opportunity_score": 130480979.54
      },
      {
        "job": "admin.",
        "count": 81492,
        "rate": 11.65,
        "avg_metric": 1019.92,
        "opportunity_score": 73436609.72
      },
      {
        "job": "services",
        "count": 64209,
        "rate": 8.27,
        "avg_metric": 834.63,
        "opportunity_score": 49157784.87
      }
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:06.193362",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.9102709293365479
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Score each job by opportunity: (count * (1 - subscription_rate) * avg_balance). Return a DataFrame with top 5 segments showing [count, rate (percentage 0-100), avg_metric, opportunity_score], sorted by score descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_018",
    "question": "Find the month with the lowest subscription rate. Within that group, what is the lowest average balance?",
    "exec_success": true,
    "correct": true,
    "generated_code": "# Calculate subscription rate for each month\nsubscription_rate = df['y'].groupby(df['month']).mean().reset_index()\n\n# Find the month with the lowest subscription rate\nlowest_subscription_month = subscription_rate.loc[subscription_rate['y'].idxmin()]['month']\n\n# Calculate average balance for this month\nresult = df.loc[df['month'] == lowest_subscription_month]['balance'].mean()",
    "result": 917.7608652823201,
    "expected": 917.76,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:08.122491",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.4683749675750732
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with the lowest subscription rate. Within that group, what is the lowest average balance?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_019",
    "question": "Among customers in the top quartile of day, which month categories have below-average subscription rate? Return sorted list.",
    "exec_success": false,
    "correct": false,
    "generated_code": null,
    "result": null,
    "expected": [
      "aug",
      "jan",
      "jul",
      "may"
    ],
    "error": "name 'avg_subscription_rate' is not defined",
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:09.609782",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.670037031173706
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Among customers in the top quartile of day, which month categories have below-average subscription rate? Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_020",
    "question": "Find the month with highest average age. What is the subscription rate for that segment?",
    "exec_success": true,
    "correct": false,
    "generated_code": "avg_age = df.groupby('month')['age'].mean().reset_index()\nmax_avg_age_month = avg_age.loc[avg_age['age'].idxmax()]['month']\nresult = df[df['month'] == max_avg_age_month]['y'].mean()",
    "result": 0.49000434593654935,
    "expected": 49.0,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:11.304400",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.6080398559570312
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with highest average age. What is the subscription rate for that segment?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_021",
    "question": "Show the subscription percentage breakdown by month. Return a DataFrame with columns [month, count, rate] where rate is percentage (0-100), sorted by rate descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = (df.groupby('month')['y'].mean() * 100).reset_index(name='rate').sort_values('rate', ascending=False)\nresult['count'] = df['month'].value_counts()",
    "result": [
      {
        "month": "mar",
        "rate": 57.135470527404344,
        "count": NaN
      },
      {
        "month": "sep",
        "rate": 53.475502766905116,
        "count": NaN
      },
      {
        "month": "dec",
        "rate": 51.3291445142581,
        "count": NaN
      },
      {
        "month": "oct",
        "rate": 49.00043459365494,
        "count": NaN
      },
      {
        "month": "apr",
        "rate": 23.56542994748179,
        "count": NaN
      },
      {
        "month": "feb",
        "rate": 20.680120177607613,
        "count": NaN
      },
      {
        "month": "jan",
        "rate": 12.41484923694355,
        "count": NaN
      },
      {
        "month": "aug",
        "rate": 11.216135465896834,
        "count": NaN
      },
      {
        "month": "nov",
        "rate": 10.98059398746632,
        "count": NaN
      },
      {
        "month": "jun",
        "rate": 10.372584605530053,
        "count": NaN
      },
      {
        "month": "jul",
        "rate": 9.084746988169584,
        "count": NaN
      },
      {
        "month": "may",
        "rate": 7.1353831470463325,
        "count": NaN
      }
    ],
    "expected": [
      {
        "month": "mar",
        "count": 5802,
        "rate": 57.14
      },
      {
        "month": "sep",
        "count": 7409,
        "rate": 53.48
      },
      {
        "month": "dec",
        "count": 2069,
        "rate": 51.33
      },
      {
        "month": "oct",
        "count": 9204,
        "rate": 49.0
      },
      {
        "month": "apr",
        "count": 41319,
        "rate": 23.57
      },
      {
        "month": "feb",
        "count": 37611,
        "rate": 20.68
      },
      {
        "month": "jan",
        "count": 18937,
        "rate": 12.41
      },
      {
        "month": "aug",
        "count": 128859,
        "rate": 11.22
      },
      {
        "month": "nov",
        "count": 66062,
        "rate": 10.98
      },
      {
        "month": "jun",
        "count": 93670,
        "rate": 10.37
      },
      {
        "month": "jul",
        "count": 110647,
        "rate": 9.08
      },
      {
        "month": "may",
        "count": 228411,
        "rate": 7.14
      }
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:12.931380",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.2500386238098145
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the subscription percentage breakdown by month. Return a DataFrame with columns [month, count, rate] where rate is percentage (0-100), sorted by rate descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_022",
    "question": "Divide customers into 4 day quartiles. What is the subscription percentage (0-100) in the lowest (bottom 25%) (Q1) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "q1 = df['day'].quantile(0.25)\nresult = (df.loc[df['day'] <= q1, 'y'].mean() * 100).round(2)",
    "result": 13.43,
    "expected": 13.43,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:15.200499",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.4541871547698975
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 day quartiles. What is the subscription percentage (0-100) in the lowest (bottom 25%) (Q1) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_023",
    "question": "How much higher is the subscription rate for month='may' compared to month='jun'? Return percentage points difference.",
    "exec_success": true,
    "correct": true,
    "generated_code": "may_subscription_rate = (df[df['month'] == 'may']['y'].mean() * 100)\njun_subscription_rate = (df[df['month'] == 'jun']['y'].mean() * 100)\nresult = may_subscription_rate - jun_subscription_rate",
    "result": -3.23720145848372,
    "expected": -3.24,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:16.673688",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.6690340042114258
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate for month='may' compared to month='jun'? Return percentage points difference.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_024",
    "question": "How much higher is the subscription rate in the Q4 day quartile compared to Q2? Return percentage points.",
    "exec_success": true,
    "correct": false,
    "generated_code": "q4 = df[df['day'] > 25].shape[0]\nq2 = df[df['day'] <= 15].shape[0]\n\nresult = (df[df['day'] > 25]['y'].mean() * 100 - df[df['day'] <= 15]['y'].mean() * 100)",
    "result": -3.4755321635577463,
    "expected": -2.48,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:18.361882",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.9389729499816895
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate in the Q4 day quartile compared to Q2? Return percentage points.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_025",
    "question": "Divide customers into 4 day quartiles. What is the average age in the upper-middle (50-75%) (Q3) quartile?",
    "exec_success": true,
    "correct": false,
    "generated_code": "q3_start = df['day'].quantile(0.5)\nq3_end = df['day'].quantile(0.75)\nq3_df = df[(df['day'] >= q3_start) & (df['day'] <= q3_end)]\nresult = q3_df['age'].mean()",
    "result": 40.7819313023879,
    "expected": 40.33,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:20.319824",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.188123941421509
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 day quartiles. What is the average age in the upper-middle (50-75%) (Q3) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_026",
    "question": "Find the month with the highest subscription rate. Within that group, what is the lowest average day?",
    "exec_success": true,
    "correct": false,
    "generated_code": "highest_subscribed_month = df.loc[df['y'] == 1, 'month'].value_counts().index[0]\nlowest_avg_day = df.loc[(df['y'] == 1) & (df['month'] == highest_subscribed_month), 'day'].mean()\nresult = lowest_avg_day",
    "result": 15.645355258313904,
    "expected": 13.45,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:22.531786",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.0683250427246094
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with the highest subscription rate. Within that group, what is the lowest average day?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_027",
    "question": "Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the highest (top 25%) (Q4) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "q4 = df[df['balance'] > df['balance'].quantile(0.75)]\nresult = (q4['y'].sum() / len(q4)) * 100",
    "result": 20.476040437269365,
    "expected": 20.48,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:24.619097",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.1944682598114014
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the highest (top 25%) (Q4) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_028",
    "question": "Which job categories have below-average subscription rate but above-average customer count? These are opportunity segments. Return sorted list.",
    "exec_success": false,
    "correct": false,
    "generated_code": null,
    "result": null,
    "expected": [
      "admin.",
      "blue-collar",
      "services",
      "technician"
    ],
    "error": "name 'subscription_rate' is not defined",
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:26.837278",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.4495630264282227
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which job categories have below-average subscription rate but above-average customer count? These are opportunity segments. Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_029",
    "question": "What percentage of month categories have subscription rates above the overall average?",
    "exec_success": true,
    "correct": true,
    "generated_code": "avg_subscription_rate = df['y'].mean()\nresult = 100 * (df.groupby('month')['y'].mean() > avg_subscription_rate).mean()",
    "result": 58.333333333333336,
    "expected": 58.33,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:29.326634",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.2800068855285645
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: What percentage of month categories have subscription rates above the overall average?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_030",
    "question": "Find the job with the highest subscription rate. Within that group, what is the lowest average day?",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df[df['y'] == 1].groupby('job')['day'].mean().idxmin()",
    "result": "unknown",
    "expected": 15.06,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:31.625498",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.8609421253204346
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the highest subscription rate. Within that group, what is the lowest average day?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_031",
    "question": "Show the average balance breakdown by month. Include count and mean balance for each category, sorted by mean descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df.groupby('month', as_index=False)['balance'].agg(['count', 'mean']).sort_values('mean', ascending=False)",
    "result": [
      {
        "month": "mar",
        "count": 5802,
        "mean": 2416.543950361944
      },
      {
        "month": "dec",
        "count": 2069,
        "mean": 2324.6689221846304
      },
      {
        "month": "oct",
        "count": 9204,
        "mean": 2319.5298783137764
      },
      {
        "month": "sep",
        "count": 7409,
        "mean": 2285.4840059387234
      },
      {
        "month": "nov",
        "count": 66062,
        "mean": 2239.3493082256064
      },
      {
        "month": "apr",
        "count": 41319,
        "mean": 1560.2638979646167
      },
      {
        "month": "feb",
        "count": 37611,
        "mean": 1332.0408657041824
      },
      {
        "month": "jun",
        "count": 93670,
        "mean": 1331.0084125120102
      },
      {
        "month": "aug",
        "count": 128859,
        "mean": 1140.6833127682196
      },
      {
        "month": "jan",
        "count": 18937,
        "mean": 1013.8238897396631
      },
      {
        "month": "may",
        "count": 228411,
        "mean": 917.7608652823201
      },
      {
        "month": "jul",
        "count": 110647,
        "mean": 749.6430992254648
      }
    ],
    "expected": [
      {
        "month": "mar",
        "count": 5802,
        "mean_balance": 2416.54
      },
      {
        "month": "dec",
        "count": 2069,
        "mean_balance": 2324.67
      },
      {
        "month": "oct",
        "count": 9204,
        "mean_balance": 2319.53
      },
      {
        "month": "sep",
        "count": 7409,
        "mean_balance": 2285.48
      },
      {
        "month": "nov",
        "count": 66062,
        "mean_balance": 2239.35
      },
      {
        "month": "apr",
        "count": 41319,
        "mean_balance": 1560.26
      },
      {
        "month": "feb",
        "count": 37611,
        "mean_balance": 1332.04
      },
      {
        "month": "jun",
        "count": 93670,
        "mean_balance": 1331.01
      },
      {
        "month": "aug",
        "count": 128859,
        "mean_balance": 1140.68
      },
      {
        "month": "jan",
        "count": 18937,
        "mean_balance": 1013.82
      },
      {
        "month": "may",
        "count": 228411,
        "mean_balance": 917.76
      },
      {
        "month": "jul",
        "count": 110647,
        "mean_balance": 749.64
      }
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:33.505224",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.177021026611328
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the average balance breakdown by month. Include count and mean balance for each category, sorted by mean descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_032",
    "question": "How much higher is the subscription rate for job='management' compared to job='admin.'? Return percentage points difference.",
    "exec_success": true,
    "correct": true,
    "generated_code": "subscription_rates = df.groupby('job')['y'].mean()\nresult = (subscription_rates['management'] - subscription_rates['admin.']) * 100",
    "result": 3.3939067288143834,
    "expected": 3.39,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:35.701191",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.151826858520508
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate for job='management' compared to job='admin.'? Return percentage points difference.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_033",
    "question": "What percentage of job='management' customers have day above the overall average day?",
    "exec_success": true,
    "correct": true,
    "generated_code": "avg_day = df['day'].mean()\nmanagement_day_above_avg = df[(df['job'] == 'management') & (df['day'] > avg_day)]\nresult = (len(management_day_above_avg) / len(df[df['job'] == 'management'])) * 100",
    "result": 53.87972040719832,
    "expected": 53.88,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:37.872128",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.210515022277832
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: What percentage of job='management' customers have day above the overall average day?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_034",
    "question": "Which month categories have below-average subscription rate but above-average customer count? These are opportunity segments. Return sorted list.",
    "exec_success": true,
    "correct": false,
    "generated_code": "avg_subscription_rate = df['y'].mean()\navg_customer_count = df.shape[0] / df['month'].nunique()\n\nresult = df.groupby('month')['y'].mean().reset_index()\nresult['customer_count'] = df['month'].value_counts()\nresult = result[(result['y'] < avg_subscription_rate) & (result['customer_count'] > avg_customer_count)]\nresult = result[['month', 'y', 'customer_count']].sort_values('y').reset_index(drop=True)",
    "result": [],
    "expected": [
      "aug",
      "jul",
      "jun",
      "may",
      "nov"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:40.104277",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.299574136734009
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories have below-average subscription rate but above-average customer count? These are opportunity segments. Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_035",
    "question": "Show the average age breakdown by job. Include count and mean age for each category, sorted by mean descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df.groupby('job')['age'].agg(['count', 'mean']).sort_values('mean', ascending=False)",
    "result": [
      {
        "count": 35185,
        "mean": 60.48716782719909
      },
      {
        "count": 2917,
        "mean": 48.32944806307851
      },
      {
        "count": 15912,
        "mean": 47.18489190548014
      },
      {
        "count": 17718,
        "mean": 42.557625014109945
      },
      {
        "count": 17634,
        "mean": 40.97017126006578
      },
      {
        "count": 170498,
        "mean": 40.450063930368685
      },
      {
        "count": 19020,
        "mean": 40.42350157728707
      },
      {
        "count": 175541,
        "mean": 40.19645552890778
      },
      {
        "count": 81492,
        "mean": 39.67802974525107
      },
      {
        "count": 138107,
        "mean": 39.311034198121746
      },
      {
        "count": 64209,
        "mean": 38.9360058558769
      },
      {
        "count": 11767,
        "mean": 26.686411149825783
      }
    ],
    "expected": [
      {
        "job": "retired",
        "count": 35185,
        "mean_age": 60.49
      },
      {
        "job": "unknown",
        "count": 2917,
        "mean_age": 48.33
      },
      {
        "job": "housemaid",
        "count": 15912,
        "mean_age": 47.18
      },
      {
        "job": "entrepreneur",
        "count": 17718,
        "mean_age": 42.56
      },
      {
        "job": "unemployed",
        "count": 17634,
        "mean_age": 40.97
      },
      {
        "job": "blue-collar",
        "count": 170498,
        "mean_age": 40.45
      },
      {
        "job": "self-employed",
        "count": 19020,
        "mean_age": 40.42
      },
      {
        "job": "management",
        "count": 175541,
        "mean_age": 40.2
      },
      {
        "job": "admin.",
        "count": 81492,
        "mean_age": 39.68
      },
      {
        "job": "technician",
        "count": 138107,
        "mean_age": 39.31
      },
      {
        "job": "services",
        "count": 64209,
        "mean_age": 38.94
      },
      {
        "job": "student",
        "count": 11767,
        "mean_age": 26.69
      }
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:42.421308",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.3756580352783203
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the average age breakdown by job. Include count and mean age for each category, sorted by mean descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_036",
    "question": "Find the job with the lowest subscription rate. Within that group, what is the highest average day?",
    "exec_success": true,
    "correct": true,
    "generated_code": "job_sub_rate = df.groupby('job')['y'].mean()\nresult = df.loc[df['job'] == job_sub_rate.idxmin(), 'day'].mean()",
    "result": 15.703973067132752,
    "expected": 15.7,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:43.815953",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.5905117988586426
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the lowest subscription rate. Within that group, what is the highest average day?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_037",
    "question": "Which job categories would have the biggest impact if brought to average subscription rate? Return top 3 by potential gain (count * rate gap), sorted by impact.",
    "exec_success": true,
    "correct": false,
    "generated_code": "# Calculate the subscription rate for the entire dataset\noverall_rate = (df['y'] == 1).mean()\n\n# Group by job and calculate the subscription rate for each job category\njob_rates = df.groupby('job')['y'].mean().reset_index()\n\n# Merge the job rates with the count of customers in each job category\njob_counts = df['job'].value_counts().reset_index()\njob_counts.columns = ['job', 'count']\n\nresult = pd.merge(job_rates, job_counts, on='job')\n\n# Calculate the potential gain for each job category\nresult['potential_gain'] = result['count'] * (overall_rate - result['y'])\n\n# Sort the results by potential gain and select the top 3\nresult = result.sort_values('potential_gain', ascending=False).head(3)",
    "result": [
      {
        "job": "blue-collar",
        "y": 0.06743774120517543,
        "count": 170498,
        "potential_gain": 9072.697365333333
      },
      {
        "job": "services",
        "y": 0.08271426124063605,
        "count": 64209,
        "potential_gain": 2435.858656
      },
      {
        "job": "entrepreneur",
        "y": 0.08138616096624901,
        "count": 17718,
        "potential_gain": 695.6885120000001
      }
    ],
    "expected": [
      "blue-collar",
      "services",
      "entrepreneur"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:45.425406",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.096707820892334
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which job categories would have the biggest impact if brought to average subscription rate? Return top 3 by potential gain (count * rate gap), sorted by impact.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_038",
    "question": "Find the month with the highest subscription rate. Within that group, what is the lowest average balance?",
    "exec_success": true,
    "correct": true,
    "generated_code": "# Group by month and calculate subscription rate\nsubscription_rate = df.groupby('month')['y'].mean().reset_index()\n\n# Find the month with the highest subscription rate\nbest_month = subscription_rate.loc[subscription_rate['y'].idxmax()]['month']\n\n# Group by month and calculate average balance for the best month\naverage_balance = df[df['month'] == best_month].groupby('month')['balance'].mean().reset_index()\n\n# Find the lowest average balance for the best month\nresult = average_balance['balance'].min()",
    "result": 2416.543950361944,
    "expected": 2416.54,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:48.540964",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.6729159355163574
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with the highest subscription rate. Within that group, what is the lowest average balance?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_039",
    "question": "Show the subscription percentage breakdown by day quartiles. Return a DataFrame with columns [quartile, count, rate] where rate is percentage (0-100).",
    "exec_success": true,
    "correct": false,
    "generated_code": "q = pd.qcut(df['day'], q=4, labels=False)\nresult = df['y'].groupby(q).mean().reset_index()\nresult.columns = ['quartile', 'rate']\nresult['count'] = df['y'].groupby(q).count()\nresult['rate'] *= 100",
    "result": [
      {
        "quartile": 0,
        "rate": 13.428062915105125,
        "count": 207327
      },
      {
        "quartile": 1,
        "rate": 14.038691138676974,
        "count": 197668
      },
      {
        "quartile": 2,
        "rate": 8.433568367205863,
        "count": 159126
      },
      {
        "quartile": 3,
        "rate": 11.55482867887174,
        "count": 185879
      }
    ],
    "expected": [
      {
        "quartile": "Q1",
        "count": 207327,
        "rate": 13.43
      },
      {
        "quartile": "Q2",
        "count": 197668,
        "rate": 14.04
      },
      {
        "quartile": "Q3",
        "count": 159126,
        "rate": 8.43
      },
      {
        "quartile": "Q4",
        "count": 185879,
        "rate": 11.55
      }
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:51.232797",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.091533899307251
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the subscription percentage breakdown by day quartiles. Return a DataFrame with columns [quartile, count, rate] where rate is percentage (0-100).",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_040",
    "question": "Among customers in the top quartile of age, which month categories have below-average subscription rate? Return sorted list.",
    "exec_success": true,
    "correct": false,
    "generated_code": "age_threshold = df['age'].quantile(0.75)\ntop_age_df = df[df['age'] >= age_threshold]\nresult = top_age_df.groupby('month')['y'].mean().lt(top_age_df['y'].mean()).sort_index().index.tolist()",
    "result": [
      "apr",
      "aug",
      "dec",
      "feb",
      "jan",
      "jul",
      "jun",
      "mar",
      "may",
      "nov",
      "oct",
      "sep"
    ],
    "expected": [
      "aug",
      "jul",
      "jun",
      "may",
      "nov"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:53.343147",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.240985155105591
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Among customers in the top quartile of age, which month categories have below-average subscription rate? Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_041",
    "question": "Find the job with the highest subscription rate. Within that group, what is the highest average age?",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df[df['y'] == 1].groupby('job')['age'].mean().idxmax()",
    "result": "retired",
    "expected": 26.69,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:55.608177",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.884401798248291
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the highest subscription rate. Within that group, what is the highest average age?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_042",
    "question": "Divide customers into 4 age quartiles. What is the subscription percentage (0-100) in the upper-middle (50-75%) (Q3) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "q3 = df['age'].quantile(0.75)\nq1 = df['age'].quantile(0.5)\nq3_customers = df[(df['age'] > q1) & (df['age'] <= q3)]\nresult = (q3_customers['y'].sum() / len(q3_customers)) * 100",
    "result": 9.103585876958013,
    "expected": 9.1,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:57.511574",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.6093449592590332
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 age quartiles. What is the subscription percentage (0-100) in the upper-middle (50-75%) (Q3) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_043",
    "question": "Divide customers into 4 balance quartiles. What is the average balance in the highest (top 25%) (Q4) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "q4 = df['balance'].quantile(0.75)\nresult = df[df['balance'] > q4]['balance'].mean()",
    "result": 3759.8649901470203,
    "expected": 3759.86,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:50:59.144515",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 1.6934189796447754
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 balance quartiles. What is the average balance in the highest (top 25%) (Q4) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_044",
    "question": "Which month categories have subscription rates below 10%? Return as a sorted list.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df[df['y'] == 1].groupby('month')['y'].mean().sort_values().loc[lambda x: x < 0.1].index.tolist()",
    "result": [],
    "expected": [
      "jul",
      "may"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:51:00.856750",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.208976984024048
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories have subscription rates below 10%? Return as a sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_045",
    "question": "Which month categories would have the biggest impact if brought to average subscription rate? Return top 3 by potential gain (count * rate gap), sorted by impact.",
    "exec_success": true,
    "correct": false,
    "generated_code": "month_subscription_rate = df.groupby('month')['y'].mean().reset_index()\nmonth_subscription_rate['month_count'] = df['month'].value_counts()\nmonth_subscription_rate['avg_subscription_rate'] = df['y'].mean()\nmonth_subscription_rate['rate_gap'] = month_subscription_rate['avg_subscription_rate'] - month_subscription_rate['y']\nmonth_subscription_rate['impact'] = month_subscription_rate['month_count'] * month_subscription_rate['rate_gap']\n\nresult = month_subscription_rate.nlargest(3, 'impact')[['month', 'impact']]",
    "result": [
      {
        "month": "apr",
        "impact": NaN
      },
      {
        "month": "aug",
        "impact": NaN
      },
      {
        "month": "dec",
        "impact": NaN
      }
    ],
    "expected": [
      "may",
      "jul",
      "jun"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:51:03.084571",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.327831983566284
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories would have the biggest impact if brought to average subscription rate? Return top 3 by potential gain (count * rate gap), sorted by impact.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_046",
    "question": "Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the upper-middle (50-75%) (Q3) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "q3_balance = df['balance'].quantile(0.75)\nq2_balance = df['balance'].quantile(0.5)\nq3_customers = df[(df['balance'] > q2_balance) & (df['balance'] <= q3_balance)]\nresult = (q3_customers['y'].sum() / len(q3_customers)) * 100",
    "result": 13.716309182247727,
    "expected": 13.72,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:51:05.429224",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.435391902923584
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the upper-middle (50-75%) (Q3) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_047",
    "question": "What percentage of job categories have subscription rates above the overall average?",
    "exec_success": true,
    "correct": true,
    "generated_code": "# Calculate overall average subscription rate\noverall_avg = df['y'].mean()\n\n# Group by job and calculate subscription rates for each job\njob_rates = df.groupby('job')['y'].mean()\n\n# Calculate percentage of job categories with rates above overall average\nresult = (job_rates > overall_avg).sum() / len(job_rates) * 100",
    "result": 50.0,
    "expected": 50.0,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:51:07.888379",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.034029960632324
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: What percentage of job categories have subscription rates above the overall average?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_048",
    "question": "Find the month with lowest average balance. What is the subscription rate for that segment?",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df.loc[df.groupby('month')['balance'].transform('mean') == df.groupby('month')['balance'].mean().min(), 'y'].mean()",
    "result": 0.09084746988169584,
    "expected": 9.08,
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:51:09.941338",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.5231308937072754
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with lowest average balance. What is the subscription rate for that segment?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_049",
    "question": "Which month categories have subscription rates above 10%? Return as a sorted list.",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = df.groupby('month')['y'].mean().reset_index()\nresult = result[result['y'] > 0.1]['month'].sort_values().tolist()",
    "result": [
      "apr",
      "aug",
      "dec",
      "feb",
      "jan",
      "jun",
      "mar",
      "nov",
      "oct",
      "sep"
    ],
    "expected": [
      "apr",
      "aug",
      "dec",
      "feb",
      "jan",
      "jun",
      "mar",
      "nov",
      "oct",
      "sep"
    ],
    "error": null,
    "model_id": "meta-llama/llama-3.1-70b-instruct",
    "timestamp": "2025-12-14T13:51:12.483323",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.785099983215332
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories have subscription rates above 10%? Return as a sorted list.",
        "role": "user"
      }
    ]
  }
]