[
  {
    "question_id": "bank_hard_001",
    "question": "Divide customers into 4 day quartiles. What is the subscription percentage (0-100) in the lower-middle (25-50%) (Q2) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "df['quartile'] = pd.qcut(df['day'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nq2 = df[df['quartile'] == 'Q2']\nresult = q2['y'].mean() * 100",
    "result": 14.038691138676974,
    "expected": 14.04,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:19.951650",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.997494220733643
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 day quartiles. What is the subscription percentage (0-100) in the lower-middle (25-50%) (Q2) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_002",
    "question": "Show the subscription percentage breakdown by job. Return a DataFrame with columns [job, count, rate] where rate is percentage (0-100), sorted by rate descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "grouped = df.groupby('job').agg(\n    count=('y', 'size'),\n    subscribed=('y', 'sum')\n).reset_index()\ngrouped['rate'] = (grouped['subscribed'] / grouped['count'] * 100).round(2)\nresult = grouped[['job', 'count', 'rate']].sort_values('rate', ascending=False)",
    "result": [
      {
        "job": "student",
        "count": 11767,
        "rate": 34.08
      },
      {
        "job": "retired",
        "count": 35185,
        "rate": 24.62
      },
      {
        "job": "unemployed",
        "count": 17634,
        "rate": 17.98
      },
      {
        "job": "management",
        "count": 175541,
        "rate": 15.04
      },
      {
        "job": "self-employed",
        "count": 19020,
        "rate": 12.94
      },
      {
        "job": "unknown",
        "count": 2917,
        "rate": 12.07
      },
      {
        "job": "technician",
        "count": 138107,
        "rate": 11.83
      },
      {
        "job": "admin.",
        "count": 81492,
        "rate": 11.65
      },
      {
        "job": "housemaid",
        "count": 15912,
        "rate": 8.47
      },
      {
        "job": "services",
        "count": 64209,
        "rate": 8.27
      },
      {
        "job": "entrepreneur",
        "count": 17718,
        "rate": 8.14
      },
      {
        "job": "blue-collar",
        "count": 170498,
        "rate": 6.74
      }
    ],
    "expected": [
      {
        "job": "student",
        "count": 11767,
        "rate": 34.08
      },
      {
        "job": "retired",
        "count": 35185,
        "rate": 24.62
      },
      {
        "job": "unemployed",
        "count": 17634,
        "rate": 17.98
      },
      {
        "job": "management",
        "count": 175541,
        "rate": 15.04
      },
      {
        "job": "self-employed",
        "count": 19020,
        "rate": 12.94
      },
      {
        "job": "unknown",
        "count": 2917,
        "rate": 12.07
      },
      {
        "job": "technician",
        "count": 138107,
        "rate": 11.83
      },
      {
        "job": "admin.",
        "count": 81492,
        "rate": 11.65
      },
      {
        "job": "housemaid",
        "count": 15912,
        "rate": 8.47
      },
      {
        "job": "services",
        "count": 64209,
        "rate": 8.27
      },
      {
        "job": "entrepreneur",
        "count": 17718,
        "rate": 8.14
      },
      {
        "job": "blue-collar",
        "count": 170498,
        "rate": 6.74
      }
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:24.973274",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.902090072631836
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the subscription percentage breakdown by job. Return a DataFrame with columns [job, count, rate] where rate is percentage (0-100), sorted by rate descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_003",
    "question": "Rank job categories by customer count. Return the top 3 as a list from highest to lowest count.",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = df['job'].value_counts().head(3).index.tolist()",
    "result": [
      "management",
      "blue-collar",
      "technician"
    ],
    "expected": [
      "management",
      "blue-collar",
      "technician"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:27.894232",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.330644130706787
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Rank job categories by customer count. Return the top 3 as a list from highest to lowest count.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_004",
    "question": "Which month categories are anomalies - having above-median balance but below-median subscription rate? Return sorted list.",
    "exec_success": true,
    "correct": false,
    "generated_code": "overall_median_balance = df['balance'].median()\nmonthly_stats = df.groupby('month').agg({\n    'balance': 'median',\n    'y': 'mean'\n}).rename(columns={'balance': 'med_balance', 'y': 'sub_rate'})\nmedian_sub_rate = monthly_stats['sub_rate'].median()\nanomalies = monthly_stats[(monthly_stats['med_balance'] > overall_median_balance) & \n                          (monthly_stats['sub_rate'] < median_sub_rate)]\nresult = sorted(anomalies.index.tolist())",
    "result": [
      "jan",
      "jun",
      "nov"
    ],
    "expected": [
      "nov"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:30.243740",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 10.598008871078491
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories are anomalies - having above-median balance but below-median subscription rate? Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_005",
    "question": "Find the job with the lowest subscription rate. Within that group, what is the lowest average age?",
    "exec_success": true,
    "correct": true,
    "generated_code": "subscription_rates = df.groupby('job')['y'].mean()\nlowest_job = subscription_rates.idxmin()\nresult = df[df['job'] == lowest_job]['age'].mean()",
    "result": 40.450063930368685,
    "expected": 40.45,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:40.860608",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.338815212249756
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the lowest subscription rate. Within that group, what is the lowest average age?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_006",
    "question": "Which month category has the highest subscription rate? If tied, return alphabetically first.",
    "exec_success": true,
    "correct": true,
    "generated_code": "rates = df.groupby('month')['y'].mean()\nmax_rate = rates.max()\ncandidates = rates[rates == max_rate]\nresult = min(candidates.index)",
    "result": "mar",
    "expected": "mar",
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:46.218510",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.456158876419067
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month category has the highest subscription rate? If tied, return alphabetically first.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_007",
    "question": "How much higher is the subscription rate for month='may' compared to month='aug'? Return percentage points difference.",
    "exec_success": true,
    "correct": true,
    "generated_code": "monthly_rates = df[df['month'].isin(['may', 'aug'])].groupby('month')['y'].mean()\nresult = 100 * (monthly_rates['may'] - monthly_rates['aug'])",
    "result": -4.0807523188505,
    "expected": -4.08,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:51.692746",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.2531421184539795
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate for month='may' compared to month='aug'? Return percentage points difference.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_008",
    "question": "Which job categories have more than 50000 customers? Return as a sorted list.",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = sorted(df['job'].value_counts()[df['job'].value_counts() > 50000].index.tolist())",
    "result": [
      "admin.",
      "blue-collar",
      "management",
      "services",
      "technician"
    ],
    "expected": [
      "admin.",
      "blue-collar",
      "management",
      "services",
      "technician"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:55.964766",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.2017440795898438
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which job categories have more than 50000 customers? Return as a sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_009",
    "question": "Which month category has the lowest average balance? If tied, return alphabetically first.",
    "exec_success": true,
    "correct": true,
    "generated_code": "monthly_avg = df.groupby('month')['balance'].mean()\nmin_avg = monthly_avg.min()\ncandidates = monthly_avg[monthly_avg == min_avg]\nresult = candidates.index.min()",
    "result": "jul",
    "expected": "jul",
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:30:59.185753",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.015032052993774
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month category has the lowest average balance? If tied, return alphabetically first.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_010",
    "question": "How much higher is the subscription rate for job='management' compared to job='services'? Return percentage points difference.",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = (df[df['job']=='management']['y'].mean() - df[df['job']=='services']['y'].mean()) * 100",
    "result": 6.767795482284769,
    "expected": 6.77,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:04.219572",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.669685125350952
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate for job='management' compared to job='services'? Return percentage points difference.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_011",
    "question": "Which job categories are anomalies - having above-median age but below-median subscription rate? Return sorted list.",
    "exec_success": true,
    "correct": false,
    "generated_code": "overall_median_age = df['age'].median()\njob_med_ages = df.groupby('job')['age'].median()\nhigh_age_jobs = job_med_ages[job_med_ages > overall_median_age].index.tolist()\n\njob_rates = df.groupby('job')['y'].mean()\noverall_median_rate = job_rates.median()\nlow_rate_jobs = job_rates[job_rates < overall_median_rate].index.tolist()\n\nanomalies = sorted(set(high_age_jobs) & set(low_rate_jobs))\nresult = anomalies",
    "result": [
      "entrepreneur",
      "housemaid"
    ],
    "expected": [
      "blue-collar",
      "entrepreneur",
      "housemaid"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:08.908145",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.3611438274383545
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which job categories are anomalies - having above-median age but below-median subscription rate? Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_012",
    "question": "How much higher is the average age for month='may' compared to month='nov'?",
    "exec_success": true,
    "correct": true,
    "generated_code": "may_avg = df[df['month'] == 'may']['age'].mean()\nnov_avg = df[df['month'] == 'nov']['age'].mean()\nresult = may_avg - nov_avg",
    "result": -2.8126264550680276,
    "expected": -2.81,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:14.288375",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.560892105102539
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the average age for month='may' compared to month='nov'?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_013",
    "question": "Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the lower-middle (25-50%) (Q2) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "df['quartile'] = pd.qcut(df['balance'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nq2 = df[df['quartile'] == 'Q2']\nresult = q2['y'].mean() * 100",
    "result": 10.961567725681821,
    "expected": 10.96,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:16.868343",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.178629159927368
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the lower-middle (25-50%) (Q2) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_014",
    "question": "How much higher is the subscription rate in the Q4 balance quartile compared to Q1? Return percentage points.",
    "exec_success": true,
    "correct": false,
    "generated_code": "quartiles = pd.qcut(df['balance'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nrates = df.assign(quartiles=quartiles).groupby('quartiles')['y'].mean()\nresult = rates['Q4'] - rates['Q1']",
    "result": 0.1694881146313335,
    "expected": 16.95,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:20.070542",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.530049085617065
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate in the Q4 balance quartile compared to Q1? Return percentage points.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_015",
    "question": "Score each job by opportunity: (count * (1 - subscription_rate) * avg_day). Return a DataFrame with top 5 segments showing [count, rate (percentage 0-100), avg_metric, opportunity_score], sorted by score descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "grouped = df.groupby('job').agg(\n    count=('y', 'size'),\n    subscription_rate=('y', 'mean'),\n    avg_day=('day', 'mean')\n)\ngrouped['rate'] = (grouped['subscription_rate'] * 100).round(2)\ngrouped['avg_metric'] = grouped['avg_day'].round(2)\ngrouped['opportunity_score'] = grouped['count'] * (1 - grouped['subscription_rate']) * grouped['avg_day']\nresult = grouped[['count', 'rate', 'avg_metric', 'opportunity_score']].sort_values('opportunity_score', ascending=False).head(5)",
    "result": [
      {
        "count": 170498,
        "rate": 6.74,
        "avg_metric": 15.7,
        "opportunity_score": 2496931.7176741078
      },
      {
        "count": 175541,
        "rate": 15.04,
        "avg_metric": 16.37,
        "opportunity_score": 2440829.7063933783
      },
      {
        "count": 138107,
        "rate": 11.83,
        "avg_metric": 16.83,
        "opportunity_score": 2049213.5010390496
      },
      {
        "count": 81492,
        "rate": 11.65,
        "avg_metric": 15.91,
        "opportunity_score": 1145651.9081873067
      },
      {
        "count": 64209,
        "rate": 8.27,
        "avg_metric": 15.97,
        "opportunity_score": 940815.9525300191
      }
    ],
    "expected": [
      {
        "job": "blue-collar",
        "count": 170498,
        "rate": 6.74,
        "avg_metric": 15.7,
        "opportunity_score": 2496931.72
      },
      {
        "job": "management",
        "count": 175541,
        "rate": 15.04,
        "avg_metric": 16.37,
        "opportunity_score": 2440829.71
      },
      {
        "job": "technician",
        "count": 138107,
        "rate": 11.83,
        "avg_metric": 16.83,
        "opportunity_score": 2049213.5
      },
      {
        "job": "admin.",
        "count": 81492,
        "rate": 11.65,
        "avg_metric": 15.91,
        "opportunity_score": 1145651.91
      },
      {
        "job": "services",
        "count": 64209,
        "rate": 8.27,
        "avg_metric": 15.97,
        "opportunity_score": 940815.95
      }
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:25.619461",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.695464134216309
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Score each job by opportunity: (count * (1 - subscription_rate) * avg_day). Return a DataFrame with top 5 segments showing [count, rate (percentage 0-100), avg_metric, opportunity_score], sorted by score descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_016",
    "question": "Find the job with the highest subscription rate. Within that group, what is the lowest average age?",
    "exec_success": true,
    "correct": true,
    "generated_code": "rates = df.groupby('job')['y'].mean()\ntop_job = rates.idxmax()\nresult = df[df['job'] == top_job]['age'].mean()",
    "result": 26.686411149825783,
    "expected": 26.69,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:31.333928",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 8.866257905960083
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the highest subscription rate. Within that group, what is the lowest average age?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_017",
    "question": "Score each job by opportunity: (count * (1 - subscription_rate) * avg_balance). Return a DataFrame with top 5 segments showing [count, rate (percentage 0-100), avg_metric, opportunity_score], sorted by score descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "grouped = df.groupby('job')\ncounts = grouped.size()\nrates = grouped['y'].mean()\navg_bal = grouped['balance'].mean()\nscores = counts * (1 - rates) * avg_bal\nresult = pd.DataFrame({\n    'count': counts,\n    'rate': (rates * 100).round(2),\n    'avg_metric': avg_bal.round(2),\n    'opportunity_score': scores.round(2)\n}).sort_values('opportunity_score', ascending=False).head(5)",
    "result": [
      {
        "count": 175541,
        "rate": 15.04,
        "avg_metric": 1510.39,
        "opportunity_score": 225260371.52
      },
      {
        "count": 170498,
        "rate": 6.74,
        "avg_metric": 977.49,
        "opportunity_score": 155421574.9
      },
      {
        "count": 138107,
        "rate": 11.83,
        "avg_metric": 1071.57,
        "opportunity_score": 130480979.54
      },
      {
        "count": 81492,
        "rate": 11.65,
        "avg_metric": 1019.92,
        "opportunity_score": 73436609.72
      },
      {
        "count": 64209,
        "rate": 8.27,
        "avg_metric": 834.63,
        "opportunity_score": 49157784.87
      }
    ],
    "expected": [
      {
        "job": "management",
        "count": 175541,
        "rate": 15.04,
        "avg_metric": 1510.39,
        "opportunity_score": 225260371.52
      },
      {
        "job": "blue-collar",
        "count": 170498,
        "rate": 6.74,
        "avg_metric": 977.49,
        "opportunity_score": 155421574.9
      },
      {
        "job": "technician",
        "count": 138107,
        "rate": 11.83,
        "avg_metric": 1071.57,
        "opportunity_score": 130480979.54
      },
      {
        "job": "admin.",
        "count": 81492,
        "rate": 11.65,
        "avg_metric": 1019.92,
        "opportunity_score": 73436609.72
      },
      {
        "job": "services",
        "count": 64209,
        "rate": 8.27,
        "avg_metric": 834.63,
        "opportunity_score": 49157784.87
      }
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:40.219157",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 6.8045690059661865
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Score each job by opportunity: (count * (1 - subscription_rate) * avg_balance). Return a DataFrame with top 5 segments showing [count, rate (percentage 0-100), avg_metric, opportunity_score], sorted by score descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_018",
    "question": "Find the month with the lowest subscription rate. Within that group, what is the lowest average balance?",
    "exec_success": true,
    "correct": false,
    "generated_code": "subscription_rates = df.groupby('month')['y'].mean()\nlowest_month = subscription_rates.idxmin()\nmonth_df = df[df['month'] == lowest_month]\navg_balances = month_df.groupby('y')['balance'].mean()\nresult = avg_balances.min()",
    "result": 856.1493213522981,
    "expected": 917.76,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:47.042869",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.612357139587402
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with the lowest subscription rate. Within that group, what is the lowest average balance?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_019",
    "question": "Among customers in the top quartile of day, which month categories have below-average subscription rate? Return sorted list.",
    "exec_success": true,
    "correct": false,
    "generated_code": "threshold = df['day'].quantile(0.75)\nsubset = df[df['day'] >= threshold]\noverall_rate = subset['y'].mean()\nmonthly_rates = subset.groupby('month')['y'].mean()\nbelow_avg = monthly_rates[monthly_rates < overall_rate].index.tolist()\nresult = sorted(below_avg)",
    "result": [
      "aug",
      "jan",
      "jul",
      "may",
      "nov"
    ],
    "expected": [
      "aug",
      "jan",
      "jul",
      "may"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:51.680790",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.839127063751221
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Among customers in the top quartile of day, which month categories have below-average subscription rate? Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_020",
    "question": "Find the month with highest average age. What is the subscription rate for that segment?",
    "exec_success": true,
    "correct": false,
    "generated_code": "avg_age = df.groupby('month')['age'].mean()\nmonth_max = avg_age.idxmax()\nsub_rate = df[df['month'] == month_max]['y'].mean()\nresult = {'month': month_max, 'subscription_rate': sub_rate}",
    "result": {
      "month": "oct",
      "subscription_rate": 0.49000434593654935
    },
    "expected": 49.0,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:31:56.544447",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.342729091644287
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with highest average age. What is the subscription rate for that segment?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_021",
    "question": "Show the subscription percentage breakdown by month. Return a DataFrame with columns [month, count, rate] where rate is percentage (0-100), sorted by rate descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "monthly = df.groupby('month').agg(\n    count=('y', 'sum'),\n    total=('y', 'count')\n).reset_index()\nmonthly['rate'] = (monthly['count'] / monthly['total']) * 100\nresult = monthly[['month', 'count', 'rate']].sort_values('rate', ascending=False)",
    "result": [
      {
        "month": "mar",
        "count": 3315,
        "rate": 57.135470527404344
      },
      {
        "month": "sep",
        "count": 3962,
        "rate": 53.475502766905116
      },
      {
        "month": "dec",
        "count": 1062,
        "rate": 51.3291445142581
      },
      {
        "month": "oct",
        "count": 4510,
        "rate": 49.00043459365494
      },
      {
        "month": "apr",
        "count": 9737,
        "rate": 23.56542994748179
      },
      {
        "month": "feb",
        "count": 7778,
        "rate": 20.680120177607613
      },
      {
        "month": "jan",
        "count": 2351,
        "rate": 12.41484923694355
      },
      {
        "month": "aug",
        "count": 14453,
        "rate": 11.216135465896834
      },
      {
        "month": "nov",
        "count": 7254,
        "rate": 10.98059398746632
      },
      {
        "month": "jun",
        "count": 9716,
        "rate": 10.372584605530053
      },
      {
        "month": "jul",
        "count": 10052,
        "rate": 9.084746988169584
      },
      {
        "month": "may",
        "count": 16298,
        "rate": 7.1353831470463325
      }
    ],
    "expected": [
      {
        "month": "mar",
        "count": 5802,
        "rate": 57.14
      },
      {
        "month": "sep",
        "count": 7409,
        "rate": 53.48
      },
      {
        "month": "dec",
        "count": 2069,
        "rate": 51.33
      },
      {
        "month": "oct",
        "count": 9204,
        "rate": 49.0
      },
      {
        "month": "apr",
        "count": 41319,
        "rate": 23.57
      },
      {
        "month": "feb",
        "count": 37611,
        "rate": 20.68
      },
      {
        "month": "jan",
        "count": 18937,
        "rate": 12.41
      },
      {
        "month": "aug",
        "count": 128859,
        "rate": 11.22
      },
      {
        "month": "nov",
        "count": 66062,
        "rate": 10.98
      },
      {
        "month": "jun",
        "count": 93670,
        "rate": 10.37
      },
      {
        "month": "jul",
        "count": 110647,
        "rate": 9.08
      },
      {
        "month": "may",
        "count": 228411,
        "rate": 7.14
      }
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:01.906137",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.6354286670684814
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the subscription percentage breakdown by month. Return a DataFrame with columns [month, count, rate] where rate is percentage (0-100), sorted by rate descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_022",
    "question": "Divide customers into 4 day quartiles. What is the subscription percentage (0-100) in the lowest (bottom 25%) (Q1) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "df['quartile'] = pd.qcut(df['day'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nq1_df = df[df['quartile'] == 'Q1']\nresult = (q1_df['y'].mean() * 100)",
    "result": 13.428062915105125,
    "expected": 13.43,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:07.560593",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.106345891952515
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 day quartiles. What is the subscription percentage (0-100) in the lowest (bottom 25%) (Q1) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_023",
    "question": "How much higher is the subscription rate for month='may' compared to month='jun'? Return percentage points difference.",
    "exec_success": true,
    "correct": true,
    "generated_code": "rate_may = df[df['month'] == 'may']['y'].mean()\nrate_jun = df[df['month'] == 'jun']['y'].mean()\nresult = (rate_may - rate_jun) * 100",
    "result": -3.2372014584837197,
    "expected": -3.24,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:12.690944",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.9884631633758545
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate for month='may' compared to month='jun'? Return percentage points difference.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_024",
    "question": "How much higher is the subscription rate in the Q4 day quartile compared to Q2? Return percentage points.",
    "exec_success": true,
    "correct": true,
    "generated_code": "df['day_quartile'] = pd.qcut(df['day'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\ngrouped = df.groupby('day_quartile')['y'].mean()\nresult = (grouped['Q4'] - grouped['Q2']) * 100",
    "result": -2.4838624598052332,
    "expected": -2.48,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:15.698308",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 6.008802890777588
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate in the Q4 day quartile compared to Q2? Return percentage points.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_025",
    "question": "Divide customers into 4 day quartiles. What is the average age in the upper-middle (50-75%) (Q3) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "result = df.groupby(pd.qcut(df['day'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4']))['age'].mean()['Q3']",
    "result": 40.3303985520908,
    "expected": 40.33,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:21.725960",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.103109121322632
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 day quartiles. What is the average age in the upper-middle (50-75%) (Q3) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_026",
    "question": "Find the month with the highest subscription rate. Within that group, what is the lowest average day?",
    "exec_success": true,
    "correct": false,
    "generated_code": "top_month = df.groupby('month')['y'].mean().idxmax()\nsubset = df[(df['month'] == top_month) & (df['y'] == 1)]\nresult = subset['day'].mean()",
    "result": 12.946907993966818,
    "expected": 13.45,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:25.848106",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 11.540516138076782
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with the highest subscription rate. Within that group, what is the lowest average day?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_027",
    "question": "Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the highest (top 25%) (Q4) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "import pandas as pd\ndf['quartile'] = pd.qcut(df['balance'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nq4 = df[df['quartile'] == 'Q4']\nresult = q4['y'].mean() * 100",
    "result": 20.476040437269365,
    "expected": 20.48,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:37.407628",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.5298521518707275
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the highest (top 25%) (Q4) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_028",
    "question": "Which job categories have below-average subscription rate but above-average customer count? These are opportunity segments. Return sorted list.",
    "exec_success": false,
    "correct": false,
    "generated_code": null,
    "result": null,
    "expected": [
      "admin.",
      "blue-collar",
      "services",
      "technician"
    ],
    "error": "name 'rates' is not defined",
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:39.961372",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.801764726638794
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which job categories have below-average subscription rate but above-average customer count? These are opportunity segments. Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_029",
    "question": "What percentage of month categories have subscription rates above the overall average?",
    "exec_success": true,
    "correct": true,
    "generated_code": "import numpy as np\noverall_avg = df['y'].mean()\nmonthly_rates = df.groupby('month')['y'].mean()\nabove_count = (monthly_rates > overall_avg).sum()\ntotal_months = len(monthly_rates)\nresult = (above_count / total_months) * 100",
    "result": 58.333333333333336,
    "expected": 58.33,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:43.782975",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.5748441219329834
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: What percentage of month categories have subscription rates above the overall average?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_030",
    "question": "Find the job with the highest subscription rate. Within that group, what is the lowest average day?",
    "exec_success": true,
    "correct": true,
    "generated_code": "rates = df.groupby('job')['y'].mean()\ntop_job = rates.idxmax()\navg_day = df[df['job'] == top_job]['day'].mean()\nresult = avg_day",
    "result": 15.062547803178381,
    "expected": 15.06,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:47.376824",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 8.13920521736145
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the highest subscription rate. Within that group, what is the lowest average day?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_031",
    "question": "Show the average balance breakdown by month. Include count and mean balance for each category, sorted by mean descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df.groupby('month')['balance'].agg(['count', 'mean']).reset_index()\nresult.columns = ['month', 'count', 'mean_balance']\nresult = result.sort_values('mean_balance', ascending=False)",
    "result": [
      {
        "month": "mar",
        "count": 5802,
        "mean_balance": 2416.543950361944
      },
      {
        "month": "dec",
        "count": 2069,
        "mean_balance": 2324.6689221846304
      },
      {
        "month": "oct",
        "count": 9204,
        "mean_balance": 2319.5298783137764
      },
      {
        "month": "sep",
        "count": 7409,
        "mean_balance": 2285.4840059387234
      },
      {
        "month": "nov",
        "count": 66062,
        "mean_balance": 2239.3493082256064
      },
      {
        "month": "apr",
        "count": 41319,
        "mean_balance": 1560.2638979646167
      },
      {
        "month": "feb",
        "count": 37611,
        "mean_balance": 1332.0408657041824
      },
      {
        "month": "jun",
        "count": 93670,
        "mean_balance": 1331.0084125120102
      },
      {
        "month": "aug",
        "count": 128859,
        "mean_balance": 1140.6833127682196
      },
      {
        "month": "jan",
        "count": 18937,
        "mean_balance": 1013.8238897396631
      },
      {
        "month": "may",
        "count": 228411,
        "mean_balance": 917.7608652823201
      },
      {
        "month": "jul",
        "count": 110647,
        "mean_balance": 749.6430992254648
      }
    ],
    "expected": [
      {
        "month": "mar",
        "count": 5802,
        "mean_balance": 2416.54
      },
      {
        "month": "dec",
        "count": 2069,
        "mean_balance": 2324.67
      },
      {
        "month": "oct",
        "count": 9204,
        "mean_balance": 2319.53
      },
      {
        "month": "sep",
        "count": 7409,
        "mean_balance": 2285.48
      },
      {
        "month": "nov",
        "count": 66062,
        "mean_balance": 2239.35
      },
      {
        "month": "apr",
        "count": 41319,
        "mean_balance": 1560.26
      },
      {
        "month": "feb",
        "count": 37611,
        "mean_balance": 1332.04
      },
      {
        "month": "jun",
        "count": 93670,
        "mean_balance": 1331.01
      },
      {
        "month": "aug",
        "count": 128859,
        "mean_balance": 1140.68
      },
      {
        "month": "jan",
        "count": 18937,
        "mean_balance": 1013.82
      },
      {
        "month": "may",
        "count": 228411,
        "mean_balance": 917.76
      },
      {
        "month": "jul",
        "count": 110647,
        "mean_balance": 749.64
      }
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:55.535020",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.160252094268799
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the average balance breakdown by month. Include count and mean balance for each category, sorted by mean descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_032",
    "question": "How much higher is the subscription rate for job='management' compared to job='admin.'? Return percentage points difference.",
    "exec_success": true,
    "correct": true,
    "generated_code": "mgmt_rate = df[df['job'] == 'management']['y'].mean()\nadmin_rate = df[df['job'] == 'admin.']['y'].mean()\nresult = (mgmt_rate - admin_rate) * 100",
    "result": 3.3939067288143834,
    "expected": 3.39,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:32:58.714414",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.282480001449585
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: How much higher is the subscription rate for job='management' compared to job='admin.'? Return percentage points difference.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_033",
    "question": "What percentage of job='management' customers have day above the overall average day?",
    "exec_success": true,
    "correct": true,
    "generated_code": "overall_avg = df['day'].mean()\nmanagement = df[df['job'] == 'management']\ntotal_mgmt = len(management)\nabove_avg = len(management[management['day'] > overall_avg])\nresult = (above_avg / total_mgmt) * 100",
    "result": 53.87972040719832,
    "expected": 53.88,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:03.016073",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.237398624420166
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: What percentage of job='management' customers have day above the overall average day?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_034",
    "question": "Which month categories have below-average subscription rate but above-average customer count? These are opportunity segments. Return sorted list.",
    "exec_success": true,
    "correct": true,
    "generated_code": "overall_rate = df['y'].mean()\nnum_months = df['month'].nunique()\navg_count = len(df) / num_months\nmonthly_stats = df.groupby('month')['y'].agg(['count', 'mean']).reset_index()\nmonthly_stats.columns = ['month', 'customer_count', 'sub_rate']\nopportunity = monthly_stats[(monthly_stats['sub_rate'] < overall_rate) & (monthly_stats['customer_count'] > avg_count)]['month'].tolist()\nresult = sorted(opportunity)",
    "result": [
      "aug",
      "jul",
      "jun",
      "may",
      "nov"
    ],
    "expected": [
      "aug",
      "jul",
      "jun",
      "may",
      "nov"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:06.277543",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.037201881408691
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories have below-average subscription rate but above-average customer count? These are opportunity segments. Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_035",
    "question": "Show the average age breakdown by job. Include count and mean age for each category, sorted by mean descending.",
    "exec_success": true,
    "correct": false,
    "generated_code": "result = df.groupby('job')['age'].agg(['count', 'mean']).sort_values('mean', ascending=False)",
    "result": [
      {
        "count": 35185,
        "mean": 60.48716782719909
      },
      {
        "count": 2917,
        "mean": 48.32944806307851
      },
      {
        "count": 15912,
        "mean": 47.18489190548014
      },
      {
        "count": 17718,
        "mean": 42.557625014109945
      },
      {
        "count": 17634,
        "mean": 40.97017126006578
      },
      {
        "count": 170498,
        "mean": 40.450063930368685
      },
      {
        "count": 19020,
        "mean": 40.42350157728707
      },
      {
        "count": 175541,
        "mean": 40.19645552890778
      },
      {
        "count": 81492,
        "mean": 39.67802974525107
      },
      {
        "count": 138107,
        "mean": 39.311034198121746
      },
      {
        "count": 64209,
        "mean": 38.9360058558769
      },
      {
        "count": 11767,
        "mean": 26.686411149825783
      }
    ],
    "expected": [
      {
        "job": "retired",
        "count": 35185,
        "mean_age": 60.49
      },
      {
        "job": "unknown",
        "count": 2917,
        "mean_age": 48.33
      },
      {
        "job": "housemaid",
        "count": 15912,
        "mean_age": 47.18
      },
      {
        "job": "entrepreneur",
        "count": 17718,
        "mean_age": 42.56
      },
      {
        "job": "unemployed",
        "count": 17634,
        "mean_age": 40.97
      },
      {
        "job": "blue-collar",
        "count": 170498,
        "mean_age": 40.45
      },
      {
        "job": "self-employed",
        "count": 19020,
        "mean_age": 40.42
      },
      {
        "job": "management",
        "count": 175541,
        "mean_age": 40.2
      },
      {
        "job": "admin.",
        "count": 81492,
        "mean_age": 39.68
      },
      {
        "job": "technician",
        "count": 138107,
        "mean_age": 39.31
      },
      {
        "job": "services",
        "count": 64209,
        "mean_age": 38.94
      },
      {
        "job": "student",
        "count": 11767,
        "mean_age": 26.69
      }
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:10.333759",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.0916850566864014
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the average age breakdown by job. Include count and mean age for each category, sorted by mean descending.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_036",
    "question": "Find the job with the lowest subscription rate. Within that group, what is the highest average day?",
    "exec_success": true,
    "correct": true,
    "generated_code": "job_rates = df.groupby('job')['y'].mean()\nlowest_job = job_rates.idxmin()\navg_day = df[df['job'] == lowest_job]['day'].mean()\nresult = avg_day",
    "result": 15.703973067132752,
    "expected": 15.7,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:13.444503",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 11.747294902801514
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the lowest subscription rate. Within that group, what is the highest average day?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_037",
    "question": "Which job categories would have the biggest impact if brought to average subscription rate? Return top 3 by potential gain (count * rate gap), sorted by impact.",
    "exec_success": true,
    "correct": false,
    "generated_code": "avg_rate = df['y'].mean()\njob_stats = df.groupby('job')['y'].agg(['count', 'mean'])\njob_stats['gap'] = avg_rate - job_stats['mean']\njob_stats['gain'] = job_stats['count'] * job_stats['gap']\nresult = job_stats[['gain']].sort_values('gain', ascending=False).head(3)",
    "result": [
      {
        "gain": 9072.697365333333
      },
      {
        "gain": 2435.858656
      },
      {
        "gain": 695.6885120000001
      }
    ],
    "expected": [
      "blue-collar",
      "services",
      "entrepreneur"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:25.210876",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.9808478355407715
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which job categories would have the biggest impact if brought to average subscription rate? Return top 3 by potential gain (count * rate gap), sorted by impact.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_038",
    "question": "Find the month with the highest subscription rate. Within that group, what is the lowest average balance?",
    "exec_success": true,
    "correct": false,
    "generated_code": "rate = df.groupby('month')['y'].mean()\nmax_month = rate.idxmax()\ndf_month = df[df['month'] == max_month]\navg_balance_by_y = df_month.groupby('y')['balance'].mean()\nresult = avg_balance_by_y.min()",
    "result": 2161.049457177322,
    "expected": 2416.54,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:30.210530",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 17.54316020011902
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with the highest subscription rate. Within that group, what is the lowest average balance?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_039",
    "question": "Show the subscription percentage breakdown by day quartiles. Return a DataFrame with columns [quartile, count, rate] where rate is percentage (0-100).",
    "exec_success": true,
    "correct": false,
    "generated_code": "df['quartile'] = pd.qcut(df['day'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nresult = df.groupby('quartile').agg(\n    count=('y', 'size'),\n    rate=('y', lambda x: x.mean() * 100)\n).reset_index()",
    "result": [
      {
        "quartile": "Q1",
        "count": 207327,
        "rate": 13.428062915105125
      },
      {
        "quartile": "Q2",
        "count": 197668,
        "rate": 14.038691138676974
      },
      {
        "quartile": "Q3",
        "count": 159126,
        "rate": 8.433568367205863
      },
      {
        "quartile": "Q4",
        "count": 185879,
        "rate": 11.55482867887174
      }
    ],
    "expected": [
      {
        "quartile": "Q1",
        "count": 207327,
        "rate": 13.43
      },
      {
        "quartile": "Q2",
        "count": 197668,
        "rate": 14.04
      },
      {
        "quartile": "Q3",
        "count": 159126,
        "rate": 8.43
      },
      {
        "quartile": "Q4",
        "count": 185879,
        "rate": 11.55
      }
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:47.772875",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.999636173248291
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Show the subscription percentage breakdown by day quartiles. Return a DataFrame with columns [quartile, count, rate] where rate is percentage (0-100).",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_040",
    "question": "Among customers in the top quartile of age, which month categories have below-average subscription rate? Return sorted list.",
    "exec_success": true,
    "correct": true,
    "generated_code": "age_threshold = df['age'].quantile(0.75)\ntop_df = df[df['age'] >= age_threshold]\noverall_rate = top_df['y'].mean()\nmonthly_rates = top_df.groupby('month')['y'].mean()\nbelow_avg_months = monthly_rates[monthly_rates < overall_rate].index.tolist()\nresult = sorted(below_avg_months)",
    "result": [
      "aug",
      "jul",
      "jun",
      "may",
      "nov"
    ],
    "expected": [
      "aug",
      "jul",
      "jun",
      "may",
      "nov"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:51.791288",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 5.445564031600952
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Among customers in the top quartile of age, which month categories have below-average subscription rate? Return sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_041",
    "question": "Find the job with the highest subscription rate. Within that group, what is the highest average age?",
    "exec_success": true,
    "correct": true,
    "generated_code": "sub_rate = df.groupby('job')['y'].mean()\nbest_job = sub_rate.idxmax()\nresult = df[df['job'] == best_job]['age'].mean()",
    "result": 26.686411149825783,
    "expected": 26.69,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:33:57.260628",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 8.039541959762573
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the job with the highest subscription rate. Within that group, what is the highest average age?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_042",
    "question": "Divide customers into 4 age quartiles. What is the subscription percentage (0-100) in the upper-middle (50-75%) (Q3) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "df['age_quartile'] = pd.qcut(df['age'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nq3_data = df[df['age_quartile'] == 'Q3']\nresult = q3_data['y'].mean() * 100",
    "result": 9.103585876958013,
    "expected": 9.1,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:34:05.319146",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.3235960006713867
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 age quartiles. What is the subscription percentage (0-100) in the upper-middle (50-75%) (Q3) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_043",
    "question": "Divide customers into 4 balance quartiles. What is the average balance in the highest (top 25%) (Q4) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "df['quartile'] = pd.qcut(df['balance'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nresult = df[df['quartile'] == 'Q4']['balance'].mean()",
    "result": 3759.8649901470203,
    "expected": 3759.86,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:34:08.666635",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.46250581741333
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 balance quartiles. What is the average balance in the highest (top 25%) (Q4) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_044",
    "question": "Which month categories have subscription rates below 10%? Return as a sorted list.",
    "exec_success": true,
    "correct": true,
    "generated_code": "monthly_rates = df.groupby('month')['y'].mean()\nbelow_10 = monthly_rates[monthly_rates < 0.1].index.tolist()\nbelow_10.sort()\nresult = below_10",
    "result": [
      "jul",
      "may"
    ],
    "expected": [
      "jul",
      "may"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:34:12.148195",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 3.253291130065918
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories have subscription rates below 10%? Return as a sorted list.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_045",
    "question": "Which month categories would have the biggest impact if brought to average subscription rate? Return top 3 by potential gain (count * rate gap), sorted by impact.",
    "exec_success": true,
    "correct": false,
    "generated_code": "avg_rate = df['y'].mean()\nmonthly = df.groupby('month').agg(count=('y', 'count'), rate=('y', 'mean'))\nmonthly['gap'] = avg_rate - monthly['rate']\nmonthly['gain'] = monthly['count'] * monthly['gap']\nresult = monthly.nlargest(3, 'gain')[['gain']]",
    "result": [
      {
        "gain": 11259.939424000002
      },
      {
        "gain": 3297.6343146666673
      },
      {
        "gain": 1585.3479466666668
      }
    ],
    "expected": [
      "may",
      "jul",
      "jun"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:34:15.420372",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 8.901182889938354
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories would have the biggest impact if brought to average subscription rate? Return top 3 by potential gain (count * rate gap), sorted by impact.",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_046",
    "question": "Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the upper-middle (50-75%) (Q3) quartile?",
    "exec_success": true,
    "correct": true,
    "generated_code": "df['quartile'] = pd.qcut(df['balance'], q=4, labels=['Q1', 'Q2', 'Q3', 'Q4'])\nq3_data = df[df['quartile'] == 'Q3']\nresult = q3_data['y'].mean() * 100",
    "result": 13.716309182247727,
    "expected": 13.72,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:34:24.340399",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.649424076080322
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Divide customers into 4 balance quartiles. What is the subscription percentage (0-100) in the upper-middle (50-75%) (Q3) quartile?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_047",
    "question": "What percentage of job categories have subscription rates above the overall average?",
    "exec_success": true,
    "correct": true,
    "generated_code": "overall_avg = df['y'].mean()\njob_rates = df.groupby('job')['y'].mean()\nnum_above = (job_rates > overall_avg).sum()\ntotal_jobs = len(job_rates)\nresult = (num_above / total_jobs) * 100",
    "result": 50.0,
    "expected": 50.0,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:34:29.013962",
    "metadata": {
      "level": "L4",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 2.4728589057922363
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: What percentage of job categories have subscription rates above the overall average?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_048",
    "question": "Find the month with lowest average balance. What is the subscription rate for that segment?",
    "exec_success": true,
    "correct": false,
    "generated_code": "monthly_avg_balance = df.groupby('month')['balance'].mean()\nlowest_month = monthly_avg_balance.idxmin()\nsubscription_rate = df[df['month'] == lowest_month]['y'].mean()\nresult = {'month': lowest_month, 'subscription_rate': subscription_rate}",
    "result": {
      "month": "jul",
      "subscription_rate": 0.09084746988169584
    },
    "expected": 9.08,
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:34:31.505600",
    "metadata": {
      "level": "L5",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.944910049438477
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Find the month with lowest average balance. What is the subscription rate for that segment?",
        "role": "user"
      }
    ]
  },
  {
    "question_id": "bank_hard_049",
    "question": "Which month categories have subscription rates above 10%? Return as a sorted list.",
    "exec_success": true,
    "correct": true,
    "generated_code": "monthly_rates = df.groupby('month')['y'].mean()\nresult = sorted(monthly_rates[monthly_rates > 0.1].index.tolist())",
    "result": [
      "apr",
      "aug",
      "dec",
      "feb",
      "jan",
      "jun",
      "mar",
      "nov",
      "oct",
      "sep"
    ],
    "expected": [
      "apr",
      "aug",
      "dec",
      "feb",
      "jan",
      "jun",
      "mar",
      "nov",
      "oct",
      "sep"
    ],
    "error": null,
    "model_id": "x-ai/grok-4-fast",
    "timestamp": "2025-12-14T13:34:36.469386",
    "metadata": {
      "level": "L3",
      "template": "unknown",
      "insight_type": "unknown",
      "df_name": "bank"
    },
    "metrics": {
      "execution_time": 4.027631998062134
    },
    "prompt": [
      {
        "content": "You are a Python data analyst expert.\nGiven a DataFrame and a question, write pandas code to answer it.\n\nRules:\n- The DataFrame is already loaded as `df`\n- Store your final answer in a variable called `result`\n- Only use pandas (pd) and numpy (np) - already imported\n- Write minimal, clean code\n- Do not print anything\n\nPut your code inside <code></code> tags.\n\nExample:\n<code>\nresult = df['column'].sum()\n</code>",
        "role": "system"
      },
      {
        "content": "DataFrame: `df` (bank)\nShape: 750000 rows \u00d7 18 columns\n\nColumns and types:\n  - id: int64\n  - age: int64\n  - job: object\n  - marital: object\n  - education: object\n  - default: object\n  - balance: int64\n  - housing: object\n  - loan: object\n  - contact: object\n  - day: int64\n  - month: object\n  - duration: int64\n  - campaign: int64\n  - pdays: int64\n  - previous: int64\n  - poutcome: object\n  - y: int64\n\nFirst 3 rows:\n|   id |   age | job         | marital   | education   | default   |   balance | housing   | loan   | contact   |   day | month   |   duration |   campaign |   pdays |   previous | poutcome   |   y |\n|-----:|------:|:------------|:----------|:------------|:----------|----------:|:----------|:-------|:----------|------:|:--------|-----------:|-----------:|--------:|-----------:|:-----------|----:|\n|    0 |    42 | technician  | married   | secondary   | no        |         7 | no        | no     | cellular  |    25 | aug     |        117 |          3 |      -1 |          0 | unknown    |   0 |\n|    1 |    38 | blue-collar | married   | secondary   | no        |       514 | no        | no     | unknown   |    18 | jun     |        185 |          1 |      -1 |          0 | unknown    |   0 |\n|    2 |    36 | blue-collar | married   | secondary   | no        |       602 | yes       | no     | unknown   |    14 | may     |        111 |          2 |      -1 |          0 | unknown    |   0 |\n\nQuestion: Which month categories have subscription rates above 10%? Return as a sorted list.",
        "role": "user"
      }
    ]
  }
]